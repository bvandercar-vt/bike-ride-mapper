name: Get Data

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * 0' # Every sunday

jobs:
  get-data:
    name: Get Data
    runs-on: ubuntu-latest
    timeout-minutes: 3
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4

      - name: Install dependencies
        uses: bahmutov/npm-install@v1

      - name: Get Data
        env:
          MMR_CLIENT_ID: ${{ secrets.MMR_CLIENT_ID }}
          MMR_AUTH_TOKEN: ${{ secrets.MMR_AUTH_TOKEN }}
          MMR_USER_ID: ${{ secrets.MMR_USER_ID }}
          SANITY_PROJECT_ID: ${{ secrets.SANITY_PROJECT_ID }}
          SANITY_API_TOKEN_WRITE: ${{ secrets.SANITY_API_TOKEN_WRITE }}
          SANITY_API_TOKEN_READ: ${{ secrets.SANITY_API_TOKEN_READ }}
        run: npm run get-data
